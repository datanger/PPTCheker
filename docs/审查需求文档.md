## PPT格式审查工具 需求文档

### 1. 背景与目标
- **背景**: 团队需要对PPT文档进行统一规范审查，减少返工与风格不一致问题。
- **目标**: 提供一款对PPT进行批量/单文件审查的工具，依据既定规则输出详细报告；在可能的情况下支持自动修复（非强制）。

### 2. 适用范围
- 输入文件格式: `.pptx`
- 适用内容: 正文文本、标题、页脚、文本框、表格、图形内文字及母版/版式中的可编辑文本。

### 3. 定义与约束
- **统一字体（中文/日文）**: 日文字体统一为 `Meiryo UI`，字号不小于 12pt。
- **英文缩略语**: 首次出现需在本页或前文给出中文或英文全称解释。
- **日文用语**: 表述流畅，优先采用日本汽车IT行业常用术语（示例词库可配置）。
- **上下文逻辑**: 页内、跨页标题与要点逻辑连贯，避免跳跃。
- **术语一致性**: 同一概念全篇使用同一术语/写法。
- **整体色调一致**: 主题/母版主色、文本/标题颜色一致。
- **颜色数量**: 单页颜色不宜过多（默认不超过 5 种可区分颜色，可配置）。

### 4. 功能需求
#### 4.1 审查入口
- 支持对单个文件或目录批量审查。
- 支持命令行与API两种使用方式（API非必须，可后续扩展）。

#### 4.2 审查规则与判定/修复（对应需求1-8）
1) 字体与字号
   - 判定: 遍历所有文本节点，若脚本为日文或包含日文字符，则字体必须为 `Meiryo UI`；所有文本字号需 >= 12pt。
   - 报告: 页码、对象类型、原字体/字号、建议值。
   - 可选自动修复: 将不合规文本字体改为 `Meiryo UI`（日文文本），将字号<12pt的文本提升至12pt；保留加粗/斜体等样式。

2) 英文缩略语解释
   - 判定: 识别大写英文缩略语（默认2-8字符），检测其首次出现前是否有全称或解释（同页或前文）。
   - 报告: 缩略语、首次出现页码、是否存在解释、建议添加位置与模板。
   - 可选自动修复: 在首次出现对象后插入注释性文本框或页脚注（可配置模板），不覆盖用户内容。

3) 日文表述与行业用语
   - 判定: 使用可配置的日文术语词库与语言流畅性检查；发现非行业常用说法或直译生硬句式。
   - 报告: 页码、原文、建议替换词/句、词库来源。
   - 可选自动修复: 仅提供替换建议与一键替换选项（默认不自动修改，避免语义偏差）。

4) 上下文逻辑连贯
   - 判定: 标题层级一致性（H1/H2风格）、要点之间的因果/并列逻辑提示词检查；跨页标题延续关系（同主题连续性）。
   - 报告: 断裂位置、层级不一致详情、建议重排或补充过渡语。
   - 可选自动修复: 提供大纲视图重排建议与过渡语模版，不自动重排。

5) 术语一致性
   - 判定: 基于术语表（可配置）与全篇N-gram相似度，发现同义多写与翻译不一致。
   - 报告: 术语族、各变体出现位置、推荐统一写法。
   - 可选自动修复: 一键统一替换（需用户确认）。

6) 整体色调一致
   - 判定: 对比页面主题/母版主色、文本/标题/形状填充色是否统一；检测是否存在临时颜色偏离主题阈值（ΔE可配置，默认近似匹配）。
   - 报告: 页码、对象、当前颜色、推荐主题色。
   - 可选自动修复: 将偏离颜色映射回最近主题色。

7) 颜色使用数量
   - 判定: 统计单页可区分颜色总数（含文本、边框、填充），默认阈值 5；超过则标记。
   - 报告: 页码、颜色统计、超标明细、精简建议。
   - 可选自动修复: 提供颜色合并建议方案，不自动替换。


