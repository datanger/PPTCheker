## PPT格式审查工具 需求文档（通用版，默认启用LLM与动态工作流）

### 1. 目标
- 支持读取用户提供的《审查需求文档》，自动配置规则与参数；如发生变更，系统可无需改代码即可适配（通过大模型理解与解析器抽取）。
- 架构保持通用，可插拔规则与工具；
- 支持两种模式：审查模式（标记与报告）、编辑模式（直接改写PPT）。

### 2. 输入
- PPTX 文件或目录
- 审查需求文档（Markdown/YAML 任一，建议Markdown按模板填写）
- 可选 LLM 配置

### 3. 规则与引擎
- 核心规则：字体/字号、缩略语解释、日文表述建议、上下文逻辑建议、术语一致性、色调一致、颜色数量
- 规则来源：
  - 固定规则（代码实现）
  - 用户规则（从《审查需求文档》解析成配置）
- 执行顺序：解析 -> 规则检查 -> 汇总Issue

### 4. 模式与输出
- 审查模式：
  - 带标记PPT（首页问题汇总 + 对象文本红色/斜体/下划线 + 中文类别尾注）
- 编辑模式：
  - 在可安全确定的项（字体/字号/颜色/术语统一）直接改写PPT（生成副本）
  - 对语言与逻辑类问题，如启用LLM，可按建议改写或仅添加备注（可配置）

### 5. LLM 工作流（默认启用，可降级）
- 输入：
  - 页文本块/标题结构/术语候选
  - 审查需求约束（从模板解析）
- 任务：
  - 日文流畅性与行业术语建议
  - 上下文逻辑过渡建议
  - 术语歧义判断与统一建议
- 输出：
  - 建议列表（含替换候选/过渡语草稿/统一术语）
  - 风险提示（不确定性/需人工确认）；若LLM未配置或失败，自动降级为纯规则。

### 6. 自动修复策略
- 安全项（默认允许）：
  - 字体（限定日文文本改为指定日文字体）
  - 字号（低于阈值提升）
  - 颜色（映射至主题近似色）
  - 术语统一（需映射表或LLM置信度高且启用）
- 风险项（默认仅建议，不自动）：
  - 日文改写、逻辑重排

### 7. 接口
```bash
pptlint --input <file_or_dir> \
        --user-req "docs/审查需求文档.md" \
        --config configs/config.yaml \
        --mode review|edit \
        --output-ppt 标记版.pptx \
        --llm deepseek  # 可选
```

### 8. 验收
- 能从《审查需求文档》解析到规则配置并生效；
- 两种模式均可正常输出；
- LLM 关闭时功能完整，开启后对语言/逻辑类问题给出更优建议或改写。

